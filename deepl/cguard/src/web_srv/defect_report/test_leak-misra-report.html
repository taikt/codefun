<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MISRA Code Analysis Report - test_leak.cpp</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: #f5eee6; min-height: 100vh; }
        .container { max-width: 100%; margin: 0; padding: 20px; width: 100vw; box-sizing: border-box; }
        .header { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header h1 { color: #2c3e50; font-size: 2.5em; margin-bottom: 10px; }
        .meta { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .meta-item { background: rgba(255,255,255,0.1); padding: 10px 15px; border-radius: 8px; backdrop-filter: blur(10px); word-break: break-all; }
        .summary { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .summary h2 { color: #2c3e50; margin-bottom: 20px; }
        .severity-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .severity-card { background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center; border-left: 4px solid #ddd; }
        .severity-card.critical { border-left-color: #dc3545; }
        .severity-card.high { border-left-color: #fd7e14; }
        .severity-card.medium { border-left-color: #ffc107; }
        .severity-card.low { border-left-color: #28a745; }
        .source-code-section { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px; border: 2px solid #e9ecef; }
        .source-code-section h3 { color: #2c3e50; margin-bottom: 15px; }
        .source-code-info { color: #6c757d; font-size: 0.9em; margin-bottom: 15px; }
        .source-code-toggle { margin-top: 20px; text-align: center; }
        .source-code-link { display: inline-block; padding: 12px 20px; background: #007acc; color: white; text-decoration: none; border-radius: 8px; font-weight: 500; transition: background-color 0.3s ease; }
        .source-code-link:hover { background: #005a9e; text-decoration: none; }
        .source-code-link:focus { outline: 2px solid #007acc; outline-offset: 2px; }
        .code-with-lines { display: flex; background: #ffffff; border-radius: 8px; overflow: hidden; width: 100%; border: 1px solid #e1e4e8; }
        .code-with-lines::-webkit-scrollbar { width: 8px; height: 8px; }
        .code-with-lines::-webkit-scrollbar-track { background: #1e1e1e; border-radius: 4px; }
        .code-with-lines::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        .code-with-lines::-webkit-scrollbar-thumb:hover { background: #aaa; }
        .code-with-lines .line-numbers { background: #f6f8fa !important; color: #586069; padding: 16px 12px 16px 16px; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; user-select: none; text-align: right; border-right: 1px solid #e1e4e8; min-width: 50px; }
        .code-with-lines .line-numbers .line-number { display: block; height: 1.5em; }
        .code-with-lines pre { margin: 0 !important; border-radius: 0 !important; flex: 1; background: #1e1e1e !important; border: none !important; }
        .code-with-lines pre code { background: transparent !important; padding: 0 !important; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; white-space: pre !important; }
        .source-code-with-lines { display: flex; background: #ffffff !important; border-radius: 8px; overflow: hidden; width: 100%; border: 1px solid #e1e4e8; }
        .source-code-with-lines::-webkit-scrollbar { width: 8px; height: 8px; }
        .source-code-with-lines::-webkit-scrollbar-track { background: #ffffff; border-radius: 4px; }
        .source-code-with-lines::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        .source-code-with-lines::-webkit-scrollbar-thumb:hover { background: #aaa; }
        .source-code-with-lines .line-numbers { background: #f6f8fa !important; color: #586069; padding: 16px 12px 16px 16px; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; user-select: none; text-align: right; border-right: 1px solid #e1e4e8; min-width: 50px; }
        .source-code-with-lines .line-numbers .line-number { display: block; height: 1.5em; }
        .source-code-with-lines pre { margin: 0 !important; padding: 0 !important; border-radius: 0 !important; flex: 1; background: #ffffff !important; border: none !important; overflow: visible; }
        .source-code-with-lines pre code { background: transparent !important; padding: 8px 16px 8px 0 !important; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; display: block; white-space: pre !important; }
        .content { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .violation { border: 1px solid #e9ecef; border-radius: 10px; margin-bottom: 20px; overflow: hidden; background: white; }
        .violation-header { background: #f8f9fa; padding: 20px; border-bottom: 1px solid #e9ecef; }
        .violation-header h3 { margin-bottom: 10px; color: #2c3e50; }
        .code-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding: 20px; }
        .code-section h4 { color: #2c3e50; margin-bottom: 15px; padding: 10px; background: #ecf0f1; border-radius: 5px; }
        .code-content { position: relative; }
        .code-content pre { margin: 0 !important; border-radius: 8px !important; background: #ffffff !important; width: 100%; border: 1px solid #e1e4e8; }
        .code-content pre::-webkit-scrollbar { width: 8px; height: 8px; }
        .code-content pre::-webkit-scrollbar-track { background: #ffffff; border-radius: 4px; }
        .code-content pre::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        .code-content pre::-webkit-scrollbar-thumb:hover { background: #aaa; }
        .hljs { background: #ffffff !important; color: #24292e !important; font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important; font-size: 14px !important; line-height: 1.5 !important; padding: 0 !important; margin: 0 !important; border: none !important; border-radius: 0 !important; }
        .code-with-lines .hljs { background: #ffffff !important; border-radius: 0 !important; padding: 0 !important; margin: 0 !important; }
        .hljs-keyword { color: #d73a49 !important; font-weight: bold; }
        .hljs-built_in { color: #005cc5 !important; }
        .hljs-type { color: #005cc5 !important; }
        .hljs-literal { color: #d73a49 !important; }
        .hljs-number { color: #005cc5 !important; }
        .hljs-string { color: #032f62 !important; }
        .hljs-comment { color: #6a737d !important; font-style: italic; }
        .hljs-function { color: #6f42c1 !important; }
        .hljs-variable { color: #e36209 !important; }
        .hljs-operator { color: #24292e !important; }
        .hljs-punctuation { color: #24292e !important; }
        .hljs-class { color: #6f42c1 !important; }
        .hljs-title { color: #6f42c1 !important; }
        .hljs-params { color: #24292e !important; }
        .line-numbers { background: #f6f8fa !important; color: #586069; padding: 16px 12px 16px 16px; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; user-select: none; text-align: right; border-right: 1px solid #e1e4e8 !important; min-width: 50px; }
        .code-with-lines .line-numbers { background: #f6f8fa !important; color: #586069; padding: 16px 12px 16px 16px; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; user-select: none; text-align: right; border-right: 1px solid #e1e4e8 !important; min-width: 50px; }
        .code-with-lines pre { margin: 0 !important; border-radius: 0 !important; flex: 1; background: #ffffff !important; padding: 0 !important; overflow: visible; }
        .code-with-lines pre code { background: transparent !important; padding: 8px 16px 8px 0 !important; font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 14px; line-height: 1.5; display: block; white-space: pre !important; }
        /* Code blocks - no collapse functionality */
        .source-code-section, .fixed-code-section { margin-top: 30px; padding: 20px; border-radius: 10px; border: 2px solid; }
        .fixed-code-section { background: linear-gradient(135deg, #e8f5e8, #c8e6c9); border-color: #4caf50; }
        .source-code-section { background: linear-gradient(135deg, #f3e5f5, #e1bee7); border-color: #9c27b0; }
        .explanation-box { background: linear-gradient(135deg, #e3f2fd, #bbdefb); border: 1px solid #2196f3; border-radius: 8px; padding: 15px; margin-top: 15px; }
        /* Gerrit-style side-by-side diff styles */
        .complete-code-comparison { margin-top: 30px; padding: 20px; border-radius: 10px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border: 2px solid #6c757d; }
        .gerrit-style-diff { background: white; border: 1px solid #d0d7de; border-radius: 8px; overflow: hidden; margin-top: 15px; font-family: 'Consolas', 'Monaco', 'Courier New', monospace; }
        .diff-header { display: grid; grid-template-columns: 1fr 1fr; background: #f6f8fa; border-bottom: 1px solid #d0d7de; }
        .diff-file-header { padding: 12px 16px; font-weight: 600; font-size: 14px; border-right: 1px solid #d0d7de; text-align: center; }
        .diff-file-header:last-child { border-right: none; }
        .diff-file-header.original { background: #fff1f0; color: #d73a49; border-right: 1px solid #d0d7de; }
        .diff-file-header.fixed { background: #f0fff4; color: #28a745; }
        .diff-content { display: grid; grid-template-columns: 1fr 1fr; align-items: start; overflow: hidden; }
        .diff-side { position: relative; overflow: auto; border-right: 1px solid #d0d7de; scrollbar-width: thin; scrollbar-color: #888 #1e1e1e; }
        .diff-side::-webkit-scrollbar { width: 8px; height: 8px; }
        .diff-side::-webkit-scrollbar-track { background: #1e1e1e; border-radius: 4px; }
        .diff-side::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        .diff-side::-webkit-scrollbar-thumb:hover { background: #aaa; }
        .diff-side:last-child { border-right: none; }
        .diff-side.original { background: #ffeef0; }
        .diff-side.fixed { background: #f0fff4; }
        .diff-side .code-content { height: 100%; position: relative; overflow: auto; }
        .diff-side .code-content .code-with-lines { height: auto; background: #ffffff !important; border-radius: 0 !important; max-height: none; overflow: visible; }
        .diff-side .code-content .line-numbers { background: #f6f8fa !important; color: #586069 !important; border-right: 1px solid #e1e4e8 !important; position: sticky; left: 0; z-index: 1; }
        .diff-side .code-content pre { margin: 0 !important; border-radius: 0 !important; height: auto; max-height: none !important; white-space: pre !important; word-wrap: break-word; font-size: 14px; line-height: 1.4; padding: 16px; overflow: visible; }
        .diff-side .hljs { background: #ffffff !important; color: #24292e !important; font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important; font-size: 14px !important; line-height: 1.45 !important; padding: 16px !important; border-radius: 0 !important; }
        .diff-line { display: block; min-height: 1.45em; padding: 0 8px; border-left: 3px solid transparent; }
        .diff-line.removed { background-color: #ffeef0; border-left-color: #f85149; }
        .diff-line.added { background-color: #f0fff4; border-left-color: #3fb950; }
        .diff-line.context { background-color: transparent; }
        .diff-line-number { display: inline-block; width: 40px; text-align: right; color: #656d76; font-size: 12px; margin-right: 8px; user-select: none; }
        @media (max-width: 768px) { .code-comparison { grid-template-columns: 1fr; } .meta { grid-template-columns: 1fr; } .severity-grid { grid-template-columns: 1fr; } .diff-header { grid-template-columns: 1fr; } .diff-content { grid-template-columns: 1fr; } .diff-side { border-right: none; border-bottom: 1px solid #d0d7de; } .diff-side:last-child { border-bottom: none; } .diff-file-header { border-right: none; border-bottom: 1px solid #d0d7de; } .diff-file-header:last-child { border-bottom: none; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛡️ MISRA Code Analysis Report</h1>
            <div class="meta">
                <div class="meta-item"><strong>📁 File:</strong> test_leak.cpp</div>
                <div class="meta-item"><strong>📍 Path:</strong> d:\src\codefun\code_test\test_leak.cpp</div>
                <div class="meta-item"><strong>⏰ Generated:</strong> 7/22/2025, 4:24:38 PM</div>
                <div class="meta-item"><strong>🤖 Analyzer:</strong> GPT-4o</div>
                <div class="meta-item"><strong>🎯 Rule Set:</strong> MISRA</div>
                <div class="meta-item"><strong>🔍 Total Issues:</strong> 5</div>
            </div>
        </div>
        <div class="summary">
            <h2>📊 Analysis Summary</h2>
            <div class="severity-grid">
                <div class="severity-card critical">
                    <h3 style="color: #dc3545;">🔴 Critical</h3>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px 0;">1</div>
                    <p>Must fix immediately</p>
                </div>
                <div class="severity-card high">
                    <h3 style="color: #fd7e14;">🟠 High</h3>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px 0;">2</div>
                    <p>Fix before release</p>
                </div>
                <div class="severity-card medium">
                    <h3 style="color: #ffc107;">🟡 Medium</h3>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px 0;">2</div>
                    <p>Improve code quality</p>
                </div>
                <div class="severity-card low">
                    <h3 style="color: #28a745;">🔵 Low</h3>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px  0;">0</div>
                    <p>Best practice recommendations</p>
                </div>
            </div>
            <!-- Original Source Code Section -->
            <div class="source-code-toggle">
                <a href="#" onclick="toggleSourceCode(); return false;" class="source-code-link">
                    📄 View Original Source Code
                </a>
            </div>
            <div class="source-code-section" id="source-code-section" style="display: none;">
                <h3>📄 Original Source Code</h3>
                <div class="source-code-info">
                    <strong>File:</strong> test_leak.cpp | 
                    <strong>Lines:</strong> 29 | 
                    <strong>Size:</strong> 0.59 KB
                </div>
                <div class="code-content">
                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span></div><pre style="white-space: pre;"><code class="language-cpp">#include &lt;iostream&gt;

class DataHolder {
public:
    DataHolder(size_t n) {
        data = new int[n]; // cấp phát động
        size = n;
    }
    void set(size_t idx, int value) {
        if (idx &lt; size) data[idx] = value;
    }
    int get(size_t idx) const {
        if (idx &lt; size) return data[idx];
        return -1;
    }
    ~DataHolder() {
    }
private:
    int* data;
    size_t size;
};

int main() {
    DataHolder* holder = new DataHolder(100);
    holder-&gt;set(0, 123);
    std::cout &lt;&lt; "holder-&gt;get(0) = " &lt;&lt; holder-&gt;get(0) &lt;&lt; std::endl;
   
    return 0;
}</code></pre></div>
                </div>
            </div>
        </div>
        <div class="content">
            <h2>🔍 Detailed Violations</h2>
            
                <div class="violation">
                    <div class="violation-header">
                        <h3>🚫 Violation 1: MISRA Rule 18-4-1 - Destructor does not release dynamically allocated memory</h3>
                        <p><strong>📍 Line:</strong> 13</p>
                        <p><strong>📝 Description:</strong> Destructor does not release dynamically allocated memory</p>
                        <p><strong>⚠️ Severity:</strong> <span style="color: #dc3545; font-weight: bold;">Critical</span></p>
                    </div>
                    <div class="gerrit-style-diff">
                        <div class="diff-header">
                            <div class="diff-file-header original">❌ Current Code (Violating)</div>
                            <div class="diff-file-header fixed">✅ Fixed Code (Compliant)</div>
                        </div>
                        <div class="diff-content">
                            <div class="diff-side original">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span></div><pre style="white-space: pre;"><code class="language-cpp">~DataHolder() {
}</code></pre></div>
                                </div>
                            </div>
                            <div class="diff-side fixed">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></div><pre style="white-space: pre;"><code class="language-cpp">~DataHolder() {
    delete[] data;
}</code></pre></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                        <div class="explanation-box">
                            <h4>💡 Explanation</h4>
                            <p>The destructor does not release the memory allocated with `new[]`, leading to a memory leak. Adding `delete[] data;` ensures proper cleanup of dynamically allocated memory.</p>
                        </div>
                    
                </div>
                
                <div class="violation">
                    <div class="violation-header">
                        <h3>🚫 Violation 2: MISRA Rule 18-4-1 - Dynamic memory allocation in constructor</h3>
                        <p><strong>📍 Line:</strong> 6</p>
                        <p><strong>📝 Description:</strong> Dynamic memory allocation in constructor</p>
                        <p><strong>⚠️ Severity:</strong> <span style="color: #fd7e14; font-weight: bold;">High</span></p>
                    </div>
                    <div class="gerrit-style-diff">
                        <div class="diff-header">
                            <div class="diff-file-header original">❌ Current Code (Violating)</div>
                            <div class="diff-file-header fixed">✅ Fixed Code (Compliant)</div>
                        </div>
                        <div class="diff-content">
                            <div class="diff-side original">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span></div><pre style="white-space: pre;"><code class="language-cpp">data = new int[n]; // cấp phát động</code></pre></div>
                                </div>
                            </div>
                            <div class="diff-side fixed">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></div><pre style="white-space: pre;"><code class="language-cpp">#include &lt;vector&gt;
// Replace raw pointer with std::vector
std::vector&lt;int&gt; data;</code></pre></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                        <div class="explanation-box">
                            <h4>💡 Explanation</h4>
                            <p>MISRA discourages dynamic memory allocation due to potential runtime failures. Using `std::vector` eliminates the need for manual memory management and ensures safer memory handling.</p>
                        </div>
                    
                </div>
                
                <div class="violation">
                    <div class="violation-header">
                        <h3>🚫 Violation 3: MISRA Rule 12-1-3 - Missing explicit keyword for single-argument constructor</h3>
                        <p><strong>📍 Line:</strong> 5</p>
                        <p><strong>📝 Description:</strong> Missing explicit keyword for single-argument constructor</p>
                        <p><strong>⚠️ Severity:</strong> <span style="color: #ffc107; font-weight: bold;">Medium</span></p>
                    </div>
                    <div class="gerrit-style-diff">
                        <div class="diff-header">
                            <div class="diff-file-header original">❌ Current Code (Violating)</div>
                            <div class="diff-file-header fixed">✅ Fixed Code (Compliant)</div>
                        </div>
                        <div class="diff-content">
                            <div class="diff-side original">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span></div><pre style="white-space: pre;"><code class="language-cpp">DataHolder(size_t n) {</code></pre></div>
                                </div>
                            </div>
                            <div class="diff-side fixed">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span></div><pre style="white-space: pre;"><code class="language-cpp">explicit DataHolder(size_t n) {</code></pre></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                        <div class="explanation-box">
                            <h4>💡 Explanation</h4>
                            <p>The constructor can be implicitly invoked, which may lead to unintended conversions. Adding `explicit` prevents such implicit conversions.</p>
                        </div>
                    
                </div>
                
                <div class="violation">
                    <div class="violation-header">
                        <h3>🚫 Violation 4: MISRA Rule 0-1-3 - Unused dynamically allocated object in `main`</h3>
                        <p><strong>📍 Line:</strong> 19</p>
                        <p><strong>📝 Description:</strong> Unused dynamically allocated object in `main`</p>
                        <p><strong>⚠️ Severity:</strong> <span style="color: #fd7e14; font-weight: bold;">High</span></p>
                    </div>
                    <div class="gerrit-style-diff">
                        <div class="diff-header">
                            <div class="diff-file-header original">❌ Current Code (Violating)</div>
                            <div class="diff-file-header fixed">✅ Fixed Code (Compliant)</div>
                        </div>
                        <div class="diff-content">
                            <div class="diff-side original">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span></div><pre style="white-space: pre;"><code class="language-cpp">DataHolder* holder = new DataHolder(100);</code></pre></div>
                                </div>
                            </div>
                            <div class="diff-side fixed">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span></div><pre style="white-space: pre;"><code class="language-cpp">DataHolder holder(100);</code></pre></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                        <div class="explanation-box">
                            <h4>💡 Explanation</h4>
                            <p>The dynamically allocated object is not deleted, causing a memory leak. Using automatic storage (`DataHolder holder`) avoids the need for manual memory management.</p>
                        </div>
                    
                </div>
                
                <div class="violation">
                    <div class="violation-header">
                        <h3>🚫 Violation 5: MISRA Rule 15-5-1 - Destructor does not handle exceptions</h3>
                        <p><strong>📍 Line:</strong> 13</p>
                        <p><strong>📝 Description:</strong> Destructor does not handle exceptions</p>
                        <p><strong>⚠️ Severity:</strong> <span style="color: #ffc107; font-weight: bold;">Medium</span></p>
                    </div>
                    <div class="gerrit-style-diff">
                        <div class="diff-header">
                            <div class="diff-file-header original">❌ Current Code (Violating)</div>
                            <div class="diff-file-header fixed">✅ Fixed Code (Compliant)</div>
                        </div>
                        <div class="diff-content">
                            <div class="diff-side original">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></div><pre style="white-space: pre;"><code class="language-cpp">~DataHolder() {
    delete[] data;
}</code></pre></div>
                                </div>
                            </div>
                            <div class="diff-side fixed">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span></div><pre style="white-space: pre;"><code class="language-cpp">~DataHolder() noexcept {
    delete[] data;
}</code></pre></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                        <div class="explanation-box">
                            <h4>💡 Explanation</h4>
                            <p>Destructors should not throw exceptions. Adding `noexcept` ensures compliance with MISRA guidelines.</p>
                        </div>
                    
                </div>
                
            
                <div class="complete-code-comparison">
                    <h2>🔄 Complete Code Comparison</h2>
                    <p>Side-by-side comparison of the original and refactored code (Gerrit-style diff):</p>
                    <div class="gerrit-style-diff">
                        <div class="diff-header">
                            <div class="diff-file-header original">📄 Original Source Code</div>
                            <div class="diff-file-header fixed">✨ Complete Fixed Code</div>
                        </div>
                        <div class="diff-content">
                            <div class="diff-side original">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span></div><pre style="white-space: pre;"><code class="language-cpp">#include &lt;iostream&gt;

class DataHolder {
public:
    DataHolder(size_t n) {
        data = new int[n]; // cấp phát động
        size = n;
    }
    void set(size_t idx, int value) {
        if (idx &lt; size) data[idx] = value;
    }
    int get(size_t idx) const {
        if (idx &lt; size) return data[idx];
        return -1;
    }
    ~DataHolder() {
    }
private:
    int* data;
    size_t size;
};

int main() {
    DataHolder* holder = new DataHolder(100);
    holder-&gt;set(0, 123);
    std::cout &lt;&lt; "holder-&gt;get(0) = " &lt;&lt; holder-&gt;get(0) &lt;&lt; std::endl;
   
    return 0;
}</code></pre></div>
                                </div>
                            </div>
                            <div class="diff-side fixed">
                                <div class="code-content">
                                    <div class="code-with-lines"><div class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span></div><pre style="white-space: pre;"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;

class DataHolder {
public:
    explicit DataHolder(size_t n) : data(n), size(n) {
    }
    void set(size_t idx, int value) {
        if (idx &lt; size) data[idx] = value;
    }
    int get(size_t idx) const {
        if (idx &lt; size) return data[idx];
        return -1;
    }
    ~DataHolder() noexcept = default;

private:
    std::vector&lt;int&gt; data;
    size_t size;
};

int main() {
    DataHolder holder(100);
    holder.set(0, 123);
    std::cout &lt;&lt; "holder.get(0) = " &lt;&lt; holder.get(0) &lt;&lt; std::endl;

    return 0;
}</code></pre></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            hljs.highlightAll();
            console.log('✅ Highlight.js initialized - syntax highlighting applied');
        });
        function toggleSourceCode() {
            const sections = document.querySelectorAll('#source-code-section, #source-code-section-2');
            const links = document.querySelectorAll('.source-code-link');
            sections.forEach((section, index) => {
                if (section) {
                    const isHidden = section.style.display === 'none';
                    section.style.display = isHidden ? 'block' : 'none';
                    const link = links[index];
                    if (link) {
                        link.textContent = isHidden ? '📄 Hide Original Source Code' : '📄 View Original Source Code';
                    }
                }
            });
        }
    </script>
</body>
</html>