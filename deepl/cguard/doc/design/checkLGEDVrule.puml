@startuml
actor User
participant "VSCode" as palette
participant "Web Server" as websrv #green
participant "Storage" as storage
box "Code Guard" #LightBlue
  participant "Controller" as controller
  participant "LGEDV Rule Engine" as ruleEngine
  participant "Prompt Builder" as promptBuilder
  participant "Report Generator" as reportGen
end box
participant "Copilot" as copilot #pink

autonumber
User -> palette : Select "Check LGEDV Rules" command
palette -> controller : Trigger 'lgedv.checkLGEDVRules' command
controller -> ruleEngine : Start LGEDV analysis for open file
ruleEngine -> promptBuilder : Build prompt (code + LGEDV rules)
promptBuilder --> ruleEngine : Return prompt
ruleEngine -> copilot : Send prompt, request analysis
copilot --> ruleEngine : Return violations result
ruleEngine -> reportGen : Generate report (HTML/Markdown)
reportGen --> ruleEngine : Return report file
ruleEngine -> controller : Return violations & report path
controller -> storage : Write result/report to storage
User -> websrv : Open report in browser
websrv -> storage : Read report file
storage --> websrv : Return report content
websrv -> User : Display report
@enduml